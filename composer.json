{
    "name": "nemo64/critical_css",
    "description": "Critical CSS inline rendering for TYPO3",
    "type": "typo3-cms-extension",
    "license": "GPL-2.0-or-later",
    "authors": [
        {
            "name": "Marco Pfeiffer",
            "email": "git@marco.zone"
        }
    ],
    "require": {
        "php": "7.0.* || 7.1.* || 7.2.*",
        "sabberworm/php-css-parser": "^8.2",
        "typo3/cms-core": "8.7.*",
        "typo3/cms-frontend": "8.7.*"
    },
    "require-dev": {
        "nimut/testing-framework": "^4.1",
        "typo3/cms-fluid-styled-content": "8.7.*"
    },
    "suggest": {
        "lochmueller/staticfilecache": "Get php out of the way before doing any frontend optimization."
    },
    "autoload": {
        "psr-4": {
            "Nemo64\\CriticalCss\\": "Classes"
        }
    },
    "autoload-dev": {
        "psr-4": {
            "Nemo64\\CriticalCss\\Tests\\": "Tests"
        }
    },
    "config": {
        "sort-packages": true,
        "vendor-dir": ".Build/vendor",
        "bin-dir": ".Build/bin"
    },
    "extra": {
        "typo3/cms": {
            "web-dir": ".Build/public",
            "app-dir": ".Build"
        }
    },
    "scripts": {
        "post-autoload-dump": [
            "mkdir -p .Build/public/typo3conf/ext",
            "ln -s ../../../../ .Build/public/typo3conf/ext/critical_css || true"
        ],
        "db:start": [
            "docker run --name `basename $PWD`_db -d -p3306:3306 -eMYSQL_ROOT_PASSWORD=password mysql:5.7 mysqld --character-set-server=utf8 --collation-server=utf8_general_ci",
            "while ! docker exec `basename $PWD`_db mysql -uroot -ppassword -e 'SELECT 1' &> /dev/null; do sleep 2; done"
        ],
        "db:stop": [
            "docker rm --force --volumes `basename $PWD`_db"
        ],
        "test:functional": [
            "rm -rf .Build/public/typo3temp/var/tests",
            "typo3DatabaseName=database typo3DatabaseHost=127.0.0.1 typo3DatabaseUsername=root typo3DatabasePassword=password phpunit -c .Build/vendor/nimut/testing-framework/res/Configuration/FunctionalTests.xml Tests/Functional"
        ],
        "test:unit": [
            "phpunit -c .Build/vendor/nimut/testing-framework/res/Configuration/UnitTests.xml Tests/Unit"
        ],
        "test": [
            "@test:unit",
            "@test:functional"
        ]
    }
}
